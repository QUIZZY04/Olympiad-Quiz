<!DOCTYPE html>
<html>
<head>
<title>Olympiad Performance Report</title>
<script src="questions.js"></script>

<style>
body{
    margin:0;
    padding:40px;
    padding-top:90px;
    background:#0f0f1b;
    font-family:Arial, sans-serif;
    color:white;
}

.container{
    max-width:1100px;
    margin:auto;
}

/* ===== TOP NAV ===== */
.top-nav{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    background:#111;
    padding:15px 30px;
    display:flex;
    justify-content:space-between;
    align-items:center;
    border-bottom:1px solid rgba(255,255,255,0.1);
    z-index:1000;
}

.nav-left{
    font-weight:bold;
    color:#ffb703;
    font-size:18px;
}

.nav-right a{
    margin-left:20px;
    text-decoration:none;
    color:white;
    transition:0.3s;
}

.nav-right a:hover{
    color:#ffb703;
}

h1{
    text-align:center;
    margin-bottom:30px;
}

.summary{
    background:#1e1e2f;
    padding:25px;
    border-radius:15px;
    margin-bottom:40px;
}

.grid{
    display:grid;
    grid-template-columns:repeat(4,1fr);
    gap:20px;
    margin-top:20px;
}

.card{
    background:#2f2f55;
    padding:15px;
    border-radius:10px;
    text-align:center;
}

.nav-btn{
    background:#ffb703;
    color:black;
    border:none;
    padding:12px 20px;
    margin:5px;
    border-radius:8px;
    cursor:pointer;
    font-weight:bold;
    transition:0.3s;
}

.nav-btn:hover{
    background:#f59e0b;
}

.analysis-box{
    background:#1e1e2f;
    padding:20px;
    border-radius:12px;
    margin-bottom:20px;
}

.correct{
    border-left:5px solid #4caf50;
}

.wrong{
    border-left:5px solid #ff4d4d;
}

.hint{
    background:#3a3a6a;
    padding:10px;
    margin-top:10px;
    border-radius:8px;
}

.solution{
    background:#2f2f55;
    padding:12px;
    margin-top:10px;
    border-radius:8px;
    border-left:4px solid #6c63ff;
}
</style>
</head>

<body>

<!-- ===== TOP NAVIGATION ===== -->
<div class="top-nav">
    <div class="nav-left">üéì Olympiad Portal</div>
    <div class="nav-right">
        <a href="dashboard.html">Dashboard</a>
        <a href="#" onclick="retakeQuiz()">Retake Quiz</a>
        <a href="#" onclick="logout()">Logout</a>
    </div>
</div>

<div class="container">

<h1>üèÜ Olympiad Performance Report</h1>

<div class="summary">
<h2>Exam Summary</h2>

<div class="grid">
<div class="card" id="total"></div>
<div class="card" id="score"></div>
<div class="card" id="accuracy"></div>
<div class="card" id="grade"></div>
</div>

<div style="margin-top:25px; text-align:center;">
    <button class="nav-btn" onclick="window.location.href='dashboard.html'">
        ‚¨Ö Back to Dashboard
    </button>
    <button class="nav-btn" onclick="retakeQuiz()">
        üîÑ Retake Quiz
    </button>
</div>

</div>

<h2>üìò Detailed Question Analysis</h2>
<div id="analysisContainer"></div>

</div>

<script>

document.addEventListener("DOMContentLoaded", function(){

const resultData = JSON.parse(localStorage.getItem("quizResult"));

if(!resultData){
    document.getElementById("analysisContainer").innerHTML =
        "<h3 style='color:red'>No quiz data found. Please attempt quiz again.</h3>";
    return;
}

const { score, total, subject, class: selectedClass, answers, questions } = resultData;

let accuracy = total ? ((score/total)*100).toFixed(2) : 0;

let grade;
if(accuracy >= 90) grade="Outstanding";
else if(accuracy >= 75) grade="Excellent";
else if(accuracy >= 60) grade="Very Good";
else if(accuracy >= 40) grade="Good";
else grade="Needs Improvement";

document.getElementById("total").innerHTML = `<strong>Total Questions</strong><br>${total}`;
document.getElementById("score").innerHTML = `<strong>Score</strong><br>${score}`;
document.getElementById("accuracy").innerHTML = `<strong>Accuracy</strong><br>${accuracy}%`;
document.getElementById("grade").innerHTML = `<strong>Performance</strong><br>${grade}`;

let analysisHTML="";

questions.forEach((q,i)=>{

    const userAns = answers[i];
    const isCorrect = userAns == q.a;

    analysisHTML += `
    <div class="analysis-box ${isCorrect ? "correct" : "wrong"}">
        <h4>Q${i+1}. ${q.q}</h4>
        <p><strong>Your Answer:</strong> ${userAns !== null && userAns !== undefined ? q.o[userAns] : "Not Attempted"}</p>
        <p><strong>Correct Answer:</strong> ${q.o[q.a]}</p>
    `;

    if(!isCorrect){
        analysisHTML += `
            <div class="hint">
                <strong>Hint:</strong><br>${q.hint || "Review the related concept carefully."}
            </div>
            <div class="solution">
                <strong>Solution:</strong><br>${q.sol || "Refer to textbook explanation for detailed solution."}
            </div>
        `;
    }

    analysisHTML += `</div>`;
});

document.getElementById("analysisContainer").innerHTML = analysisHTML;

});

/* ===== NAVIGATION FUNCTIONS ===== */

function logout(){
    localStorage.removeItem("loggedIn");
    window.location.href = "index.html";
}

function retakeQuiz(){
    localStorage.removeItem("quizResult");
    window.location.href = "quiz.html";
}

</script>

</body>
</html>
